<!-- Local HTML template loaded by WebView; replace its contents to customize the app. -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Flag Football Tracker (Touch)</title>
  <link rel="stylesheet" href="styles/app.css" />

  <!-- Firebase (compat) SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

  <script src="scripts/firebase-init.js"></script>


</head>
<body>
<script src="scripts/error-handler.js"></script>

  <header class="topbar">
    <button class="menu-toggle" id="menuToggle" aria-label="Open menu" aria-expanded="false">☰</button>
    <div class="topbar-title">Flag Football Game Tracker</div>
    <div class="view-indicator" id="viewIndicator">Ref View</div>
  </header>

  <nav class="drawer" id="menuDrawer" aria-hidden="true">
    <div class="drawer-section">
      <h2>View</h2>
      <button class="drawer-item" data-view="ref" type="button">Ref view</button>
      <button class="drawer-item" data-view="player" type="button">Player view</button>
      <button class="drawer-item" data-view="stats" type="button">Stats view</button>
      <p class="drawer-note">Refs can update the score, clock, and stats. Players and spectators see a read-only dashboard.</p>
    </div>

    <div class="drawer-section">
      <h2>Pages</h2>
      <button class="drawer-item active" data-page="game" type="button">Game dashboard</button>
      <button class="drawer-item" data-page="teams" type="button">Teams</button>
    </div>

    <div class="drawer-section">
      <h2>Live sync</h2>
      <form id="syncForm">
        <label for="syncGame">Game code</label>
        <input id="syncGame" name="game" type="text" placeholder="e.g. week1-field1" />
        <label style="display:flex;gap:8px;align-items:center;margin-top:6px;">
          <input id="joinAsWriter" type="checkbox" checked />
          <span>Join as ref (writer)</span>
        </label>
        <button class="save" type="submit">Save &amp; connect</button>
      </form>
      <button class="secondary" type="button" id="syncDisconnect">Disconnect</button>
      <p class="drawer-note">
        Enter a game code to join or host a game. First device to connect becomes the writer (ref).
      </p>
      <div class="sync-status" id="syncStatus" role="status">Offline</div>

    </div>
  </nav>
  <div class="drawer-backdrop" id="menuBackdrop" tabindex="-1" aria-hidden="true"></div>

  <div class="app">
    <section class="page active" data-page="game">
      <h1>Flag Football Game Tracker</h1>

      <div class="layout">
        <div class="primary">
          <!-- Game Clock -->
          <div class="clock">
            <div class="left">
              <div class="muted">Game Clock</div>
            <div class="banner" id="timeoutBanner" style="display:none;">Timeout — <span id="timeoutTeam"></span> <span id="timeoutTime">1:00</span></div>
            <div class="banner" id="halftimeBanner" style="display:none;">Halftime — <span id="halftimeTime">5:00</span></div>
          </div>
          <div class="time" id="gameTime" title="Tap to edit when paused">25:00</div>
          <div class="clock-controls">
            <button class="btn" id="clockStartPause" data-role="ref-only">Start</button>
            <button class="btn" id="timeoutHome" data-role="ref-only">Timeout (Home)</button>
            <button class="btn" id="timeoutAway" data-role="ref-only">Timeout (Away)</button>
            <button class="btn" id="halftimeBtn" data-role="ref-only">Halftime</button>
          </div>
        </div>

        <!-- Teams -->
        <section class="teams" id="teams"></section>
      </div>

        <!-- Stats view panel (hidden unless View=Stats) -->
        <section class="teams-panel" id="gameStatsPanel" style="display:none;">
          <header>
            <h3>Team stats (click a cell to +1)</h3>
            <span class="muted">Live totals stored in Firebase</span>
          </header>

          <div class="stats-duo" id="gameStatsDuo">
            <div class="team-slot">
              <h4 class="muted" id="gameStatsHomeTitle">Home</h4>
              <div class="stats-grid-container" id="gameStatsHome"></div>
            </div>
            <div class="team-slot">
              <h4 class="muted" id="gameStatsAwayTitle">Away</h4>
              <div class="stats-grid-container" id="gameStatsAway"></div>
            </div>
          </div>
        </section>


        <!-- Global Controls (shared by both teams) -->
      <aside class="controls-card">
        <div class="controls">
          <div class="label">Active team: <span id="activeTeamLabel">Home</span> — tap a team card to switch</div>
          <div class="row3">
            <button class="btn primary" id="g_score6" data-role="ref-only">+6</button>
            <button class="btn" id="g_score1" data-role="ref-only">+1</button>
            <button class="btn warn" id="g_scorem1" data-role="ref-only">-1</button>
          </div>
          <!-- Reordered: First Down, Guy Play, Rush, Girl Play -->
          <div class="row2">
            <button class="btn tall" id="g_downReset" data-role="ref-only">First Down</button>
            <button class="btn tall" id="g_guyPlay" data-role="ref-only">Guy Play</button>
          </div>
          <div class="row2">
            <button class="btn tall" id="g_rushm1" data-role="ref-only">Rush</button>
            <button class="btn tall" id="g_girlPlay" data-role="ref-only">Girl Play</button>
          </div>
          <div class="row1">
            <button class="btn tall warn" id="g_turnover" data-role="ref-only">Turnover</button>
          </div>
        </div>
      </aside>
    </div>
    </section>

    <section class="page" data-page="teams" id="teamsPage">
      <h1>Teams</h1>
      <div class="teams-page">
        <div class="teams-status" id="teamsPageStatus" role="status">Loading teams…</div>
        <div class="columns">
          <section class="teams-panel" aria-labelledby="teamsListHeading">
            <header>
              <h3 id="teamsListHeading">Teams</h3>
              <div class="teams-actions">
                <button class="btn-inline primary" type="button" id="teamsAddTeam">Add Team</button>
              </div>
            </header>
            <div class="list" id="teamsDirectoryList" role="listbox" aria-label="Teams"></div>
            <footer>Select a team to see its players.</footer>
          </section>
          <section class="teams-panel" aria-labelledby="playersListHeading">
            <header>
              <h3 id="playersListHeading">Players</h3>
              <div class="teams-actions">
                <button class="btn-inline" type="button" id="teamsAddPlayer">Add Player</button>
              </div>
            </header>
            <div class="list" id="teamsPlayerList" role="listbox" aria-label="Players"></div>
            <footer>Choose a player to view stats.</footer>
          </section>
          <section class="teams-panel" aria-labelledby="playerStatsHeading">
            <header>
              <h3 id="playerStatsHeading">Player stats</h3>
              <span id="teamsSelectedPlayer"></span>
            </header>
            <div class="teams-stats" id="teamsStatsList"></div>
          </section>
          <!-- Team Stats Grid -->
          <section class="teams-panel" aria-labelledby="teamStatsGridHeading">
            <header>
              <h3 id="teamStatsGridHeading">Team stats (click a cell to +1)</h3>
              <span class="muted">Live totals stored in Firebase</span>
            </header>
            <div id="teamStatsGrid" class="stats-grid-container" role="region" aria-live="polite"></div>
          </section>

        </div>
      </div>
    </section>
  </div>

<script src="scripts/app.js"></script>

<script src="scripts/triggers.js"></script>

</body>
</html>
